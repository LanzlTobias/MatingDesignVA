For running the simulation described in the paper change the path in the function "setwd('~/LD/Paper/')" in each script to your home directory and copy the files in /input and /scripts into two new directories called "input" and "scripts". Additionally create an empty directory called "output" for the output generated by the scripts.

To run the main simulation described in the paper, run the script main_simulation.R. This script can (and should) be parallelized, since it shortens the processing time significantly. For choosing the number of used threads change the "workers" argument in the function "plan(multicore, workers = 1)" (line 18) to a number suitable to the machine you're using. This script will produce the file "main_sim_result.csv", which will be saved in /output. 

To calculate means and standard errors of all parameters over all combinations of replication and set run the scripts "ANOVA_Mean.R". This script can (and should) be parallelized in the same way as the previous script. The output will be saved as "summary_df.RData" in /output. Additionally the results of all variance components will be saved in /output as "ANOVA_df.RData".

To see the verification of the formulas in Appendix A and generate the data for figures S7 and S8, run the script "Appendix_A.R". The output will be saved in /output as "Appendix_A.RData" and "Appendix_A_negative_prob.RData".

To generate the data for figure S1, run the script "figure_S1.R". The output will be saved as "figS1_expectation.RData" and "figS1_simulation.RData" in /output.

To calculate the input for figure S9, run "D_distributions.R". The output will be saved in /output as "D_ancestral.RData".

The code for generating all figures and supplements can be found in "figures.Rmd". Create an empty directory called "figures" and run the script to generate all figures as seen in the paper. Needs all output files generated from the other scripts.





Description of the scripts and input file:

LD_decay:
Script for calculating the decay of GPD in the ancestral populations.

R_functions.R:
Source file for the functions I wrote in R.

cpp_functions.cpp:
Source file for the functions I wrote in C++.

main_simulation.R:
Script for running the main simulation. Needs the source files in R and C++ as well as the input created by create_pop_foundation_v10.R. Can be parallelized by changing the amount of workers.

ANOVA_Mean.R:
Script for summarizing the output of the main simulation. Performs an ANOVA for each setting and calculates the means and standard errors. Can be parallelized by changing the amount of workers.

preparatory_sim.R
Basically main_simulation.R for 100 replications and 100 sets of QTL positions. Used for estimating the variance components of the number of sets and the number of replications.

preparatory_sim_analysis.R
Basically ANOVA_Mean.R for the output of preparatory_sim.R

Appendix_A.R:
Tests for the formulas in Appendix A.

figure_S2.R:
Simulation for the data used in figure S2

D_distributions.R
Calculates the off-diagonal values of the matrix D in the ancestral populations.

figures.Rmd: 
R Notebook for the figures in the paper.

founding_pop.RData:
Input file for the main simulation. Contains masked information for the coding of the genotypes.

